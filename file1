<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Linktern ‚Äî Explore, learn and link to curated internships, pathways and mentorship circles." />
  <title>Linktern ‚Äî Explore ‚Ä¢ Learn ‚Ä¢ Link</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />

  <style>
    /* DESIGN SYSTEM */
    :root{
      --max-width:1180px;
      --pad:18px;
      --radius:14px;
      --gap:14px;
      --ease:cubic-bezier(.22,.61,.36,1);
      --dur:420ms;

      --bg-900:#061122;
      --bg-800:#07162a;
      --surface:#0f1724;
      --muted:rgba(230,245,255,0.72);
      --text:#eaf2ff;

      --accent-mint:#4BE7C3;
      --accent-blue:#5EA7FF;
      --accent-violet:#BCA6FF;
      --accent-rose:#FF9AC2;
      --accent-amber:#FFD37A;
      --accent:var(--accent-mint);

      --focus: 0 0 0 4px color-mix(in oklab,var(--accent) 28%, transparent);
      --card-shadow: 0 12px 30px rgba(0,8,20,0.45);

      --font-sans: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      --font-mono: "JetBrains Mono", ui-monospace, Menlo, Consolas, monospace;
      --fs:1;

      --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(255,255,255,0.05);
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg-900:#f7f9ff; --bg-800:#eef4ff; --surface:#fff; --muted:#42526e; --text:#081022; --glass:rgba(0,0,0,0.04); --card-shadow:0 12px 30px rgba(6,10,23,0.06);
      }
    }

    *{box-sizing:border-box}
    html{font-family:var(--font-sans);font-size:calc(16px * var(--fs));scroll-behavior:smooth}
    body{margin:0;background:linear-gradient(180deg,var(--bg-900),var(--bg-800));color:var(--text);-webkit-font-smoothing:antialiased;min-height:100vh;line-height:1.38;overflow-x:hidden}

    .container{max-width:var(--max-width);margin:0 auto;padding:0 var(--pad)}
    .app{display:grid;grid-template-columns:84px 1fr;min-height:100vh;gap:18px;align-items:start}
    @media (max-width:980px){ .app{grid-template-columns:72px 1fr} }
    @media (max-width:720px){ .app{grid-template-columns:1fr} .sidebar{position:sticky;top:0;z-index:40} }

    .sidebar{padding:12px;display:flex;flex-direction:column;row-gap:10px;align-items:center;position:sticky;top:12px;height:calc(100vh - 24px);background:linear-gradient(180deg,var(--glass),transparent);backdrop-filter:blur(8px);border-radius:12px}
    .sb-logo{width:54px;height:54px;border-radius:12px;display:grid;place-items:center;font-weight:900;background:conic-gradient(from 120deg,var(--accent),var(--accent-blue),var(--accent-violet));box-shadow:var(--card-shadow)}
    .sb-btn{width:56px;height:56px;border-radius:12px;background:linear-gradient(180deg,var(--glass),var(--glass-2));display:grid;place-items:center;cursor:pointer;transition:transform .18s var(--ease);border:none;color:var(--text)}
    .sb-btn:hover{transform:translateY(-6px)}
    .sb-btn.active{outline:2px solid color-mix(in oklab,var(--accent) 30%, transparent);background:linear-gradient(135deg,color-mix(in oklab,var(--accent) 16%,transparent),transparent)}
    .sb-bottom{margin-top:auto;display:grid;gap:10px}

    .topbar{position:sticky;top:0;z-index:120;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);backdrop-filter: blur(8px);padding:10px 0}
    .topbar .inner{display:flex;gap:12px;align-items:center;justify-content:space-between;max-width:var(--max-width);margin:0 auto;padding:0 var(--pad)}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:linear-gradient(180deg,var(--glass),transparent);color:var(--muted);font-weight:600;font-size:.95rem}
    .chip{display:inline-flex;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-weight:600;color:var(--muted)}

    .input,select,textarea{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:10px;padding:10px;border:1px solid rgba(255,255,255,0.03);color:var(--text);outline:none}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;cursor:pointer;background:linear-gradient(180deg,var(--glass),var(--glass-2));color:var(--text);border:none;transition:transform .18s var(--ease), box-shadow .18s}
    .btn:hover{transform:translateY(-3px)}
    .btn.cta{background:linear-gradient(135deg,var(--accent), color-mix(in oklab,var(--accent-blue) 60%, var(--accent))); color:var(--bg-900); font-weight:700; box-shadow: 0 12px 28px color-mix(in oklab,var(--accent-blue) 30%, #000)}
    button:focus-visible{box-shadow:var(--focus);border-radius:10px}

    .card{background:linear-gradient(180deg,var(--surface), color-mix(in oklab,var(--surface) 96%, transparent));border-radius:var(--radius);padding:16px;box-shadow:var(--card-shadow)}
    .glass{position:relative;min-height:420px;border-radius:var(--radius);background:linear-gradient(180deg,color-mix(in oklab,#fff 4%, transparent), transparent);padding:14px;overflow:hidden;box-shadow:var(--card-shadow)}

    .hero {padding:56px 0}
    .hero .lead{color:var(--muted);font-size:1.02rem;max-width:64ch}
    .hero-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:start}
    @media (max-width:1000px){ .hero-grid{grid-template-columns:1fr} }

    section{padding:48px 0;position:relative}
    h1,h2,h3,h4{margin:0 0 8px 0}
    h1{font-size:clamp(2.2rem, 6vw, 3.6rem);line-height:1.02}
    h2{font-size:clamp(1.3rem, 2.8vw, 1.9rem)}
    .row{display:grid;gap:12px}
    .cols-2{grid-template-columns:1fr .9fr}
    .grid{display:grid;gap:12px}

    .g-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:980px){ .g-3{grid-template-columns:1fr 1fr} }
    @media (max-width:680px){ .g-3{grid-template-columns:1fr} }

    .intern-card{display:grid;grid-template-columns:56px 1fr auto;gap:12px;align-items:center;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
    .intern-company{width:56px;height:56px;border-radius:10px;display:grid;place-items:center;background:linear-gradient(180deg,var(--glass),transparent);font-weight:700}
    .intern-meta{color:var(--muted);font-size:.92rem}

    .reveal{opacity:0;transform:translateY(18px) scale(.998);transition:opacity var(--dur) var(--ease), transform var(--dur) var(--ease);will-change:transform,opacity}
    .reveal.show{opacity:1;transform:none}

    .parallax{will-change:transform}
    .magnet{transition:transform .18s var(--ease)}

    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    .toast{position:fixed;right:16px;bottom:16px;padding:12px 14px;background:linear-gradient(180deg,var(--glass-2),transparent);border-radius:12px;box-shadow:0 14px 36px rgba(0,0,0,0.35);z-index:250;opacity:0;transform:translateY(8px);transition:opacity .18s,transform .18s}
    .toast.show{opacity:1;transform:none}

    .kbd{font-family:var(--font-mono);padding:6px 8px;border-radius:8px;background:linear-gradient(180deg,var(--glass),transparent);font-size:.85rem}
    footer{padding:40px 0;background:linear-gradient(180deg, transparent, rgba(255,255,255,0.02))}

    @media (prefers-reduced-motion: reduce){
      *{transition:none!important;animation:none!important}
    }

    /* Cursor styling (small, accessible) */
    .cursor-dot, .cursor-ring { position:fixed; pointer-events:none; z-index:9999; transform:translate(-50%,-50%); transition:transform .12s linear, opacity .12s linear; opacity:0; mix-blend-mode:screen }
    .cursor-dot{width:8px;height:8px;border-radius:50%;background:var(--accent); box-shadow:0 0 8px color-mix(in oklab,var(--accent) 60%, transparent)}
    .cursor-ring{width:36px;height:36px;border-radius:50%;border:2px solid color-mix(in oklab,var(--accent) 60%, transparent); backdrop-filter: blur(2px)}
    @media (pointer:coarse){ .cursor-dot, .cursor-ring{ display:none } }
  </style>
</head>
<body>
  <a class="sr-only" href="#main">Skip to content</a>

  <!-- cursor -->
  <div class="cursor-ring" id="cursorRing" aria-hidden="true"></div>
  <div class="cursor-dot" id="cursorDot" aria-hidden="true"></div>

  <div class="app container" id="app">
    <aside class="sidebar" aria-label="Primary navigation">
      <div class="sb-logo" title="Linktern">üîó</div>
      <button class="sb-btn active" data-jump="home" title="Home" aria-current="page">üè†</button>
      <button class="sb-btn" data-jump="discover" title="Discover">üß≠</button>
      <button class="sb-btn" data-jump="pathways" title="Pathways">üó∫Ô∏è</button>
      <button class="sb-btn" data-jump="mentors" title="Mentors">üë•</button>
      <button class="sb-btn" data-jump="internships" title="Internships">üíº</button>
      <button class="sb-btn" data-jump="portfolio" title="Portfolio">üìÅ</button>

      <div class="sb-bottom" aria-hidden="false">
        <button class="sb-btn" id="openPalette" title="Command Palette (‚åò/Ctrl+K)">‚å®Ô∏è</button>
        <button class="sb-btn" id="openSettings" title="Settings">‚öôÔ∏è</button>
      </div>
    </aside>

    <div style="min-width:0">
      <div class="topbar" role="region" aria-label="Site bar">
        <div class="inner">
          <div style="display:flex;gap:10px;align-items:center;flex:1">
            <span class="pill">üåç <strong id="statCountries">0</strong> countries</span>
            <span class="pill">üë• <strong id="statLearners">0</strong> learners</span>
            <span class="chip">‚úÖ Verified roles</span>
          </div>

          <div style="display:flex;align-items:center;gap:10px;flex:1;justify-content:flex-end">
            <div style="position:relative;width:360px;max-width:48vw">
              <input id="search" class="input" placeholder="Try: data, ux, frontend, product‚Ä¶" aria-label="Search internships and tracks" />
              <div id="searchSuggest" style="position:absolute;left:0;right:0;top:46px;display:none;background:var(--surface);border-radius:10px;padding:8px;box-shadow:var(--card-shadow);z-index:80"></div>
            </div>
            <button class="btn" id="searchBtn" aria-label="Search">Search</button>
            <button class="kbd" id="kbdHint" title="Open command palette">‚åò/Ctrl + K</button>
          </div>
        </div>
      </div>

      <main id="main" tabindex="-1">
        <div class="container">
          <section id="home" class="hero" aria-labelledby="hero-heading">
            <div class="hero-grid">
              <div class="card reveal" data-parallax="0.04">
                <span class="chip">New ‚Ä¢ Aurora Flow</span>
                <h1 id="hero-heading" style="margin-top:12px">Careers that feel purposeful ‚Äî <strong style="background:linear-gradient(90deg,var(--accent),var(--accent-blue));-webkit-background-clip:text;color:transparent">guided</strong>, practical, and kind.</h1>
                <p class="lead" style="margin-top:8px">Play the quiz, explore adaptive pathways, collect badges, and match to internships that value growth and mentorship.</p>

                <div style="display:flex;gap:10px;margin-top:16px">
                  <input id="searchInline" class="input" placeholder="Search internships, companies or skills‚Ä¶" aria-label="Inline search" />
                  <button id="searchBtnInline" class="btn cta">Search</button>
                </div>

                <div style="display:flex;gap:10px;margin-top:16px;flex-wrap:wrap">
                  <button class="btn cta" id="startQuiz">üéØ Start Quiz</button>
                  <button class="btn" id="openStories">üìö Success Stories</button>
                  <button class="btn" id="openSim">üß™ Try a Simulation</button>
                </div>

                <div class="card" style="margin-top:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)">
                  <strong>Activity streak</strong>
                  <div id="heat" style="display:flex;gap:6px;align-items:center;margin-top:12px;flex-wrap:wrap"></div>
                </div>
              </div>

              <div class="glass reveal parallax" id="aurora" data-parallax="0.12" aria-hidden="true">
                <div style="display:flex;align-items:center;justify-content:space-between">
                  <strong>AI Suggestions</strong>
                  <span class="chip" id="aiStatus">Waiting for your quiz‚Ä¶</span>
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:12px">
                  <div class="card magnet" style="min-height:80px">Complete modules to unlock tailored roles.</div>
                  <div class="card magnet" style="min-height:80px">Save internships and compare up to 3.</div>
                  <div class="card magnet" style="min-height:80px">Export your portfolio JSON or print r√©sum√© view.</div>
                </div>

                <div style="display:flex;gap:10px;margin-top:12px;align-items:center;justify-content:flex-end">
                  <button class="btn" id="saveDemo">‚ú® Try demo suggestion</button>
                </div>
              </div>
            </div>
          </section>

          <section id="discover" aria-labelledby="discover-h">
            <div style="display:flex;justify-content:space-between;align-items:end;gap:12px">
              <div>
                <h2 id="discover-h">Discovery Playground</h2>
                <p class="lead">Mini challenges, simulations, and stories. Hover, tilt, drag ‚Äî everything responds.</p>
              </div>
              <div class="tabs" role="tablist" id="discTabs" style="display:flex;gap:8px">
                <button class="btn tab active" data-filter="all">All</button>
                <button class="btn tab" data-filter="tech">Tech</button>
                <button class="btn tab" data-filter="design">Design</button>
                <button class="btn tab" data-filter="biz">Business</button>
              </div>
            </div>

            <div id="discoverGrid" class="grid g-3" style="margin-top:16px"></div>
          </section>

          <section id="pathways" aria-labelledby="pathways-h">
            <div style="display:flex;justify-content:space-between;align-items:end;gap:12px">
              <div>
                <h2 id="pathways-h">Pathways that adapt to you</h2>
                <p class="lead">Switch speeds anytime. The more you do, the smarter your matches get.</p>
              </div>
              <div class="tabs" id="speedTabs" style="display:flex;gap:8px">
                <button class="btn tab active" data-speed="standard">Standard</button>
                <button class="btn tab" data-speed="intense">Intense</button>
                <button class="btn tab" data-speed="weekend">Weekend-only</button>
              </div>
            </div>

            <div style="display:grid;grid-template-columns:1fr .9fr;gap:16px;margin-top:12px">
              <div class="card">
                <h3>Choose a Track</h3>
                <p class="muted" style="margin-top:6px">Pick a field and we‚Äôll outline your next 4‚Äì6 weeks.</p>
                <div id="trackTabs" style="display:flex;gap:8px;margin-top:12px"></div>
                <div id="trackContent" style="margin-top:12px"></div>
              </div>

              <div class="card">
                <h3>Your Progress</h3>
                <p class="muted" style="margin-top:6px">Complete modules to unlock badges and tailored internship matches.</p>
                <details open style="margin-top:8px"><summary>Badges</summary>
                  <div id="badges" style="margin-top:8px;display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px"></div>
                </details>

                <details style="margin-top:10px"><summary>Recommended Internships</summary>
                  <div id="recoList" style="margin-top:10px"></div>
                </details>
              </div>
            </div>
          </section>

          <section id="mentors" aria-labelledby="mentors-h">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><h2 id="mentors-h">Mentorship Circles</h2><p class="muted">Monthly AMAs ‚Ä¢ Peer reviews ‚Ä¢ Real guidance</p></div>
              <button class="btn cta" id="joinCircle">ü§ù Join a Circle</button>
            </div>

            <div id="mentorGrid" class="grid g-4" style="margin-top:12px"></div>
          </section>

          <section id="internships" aria-labelledby="intern-h">
            <div style="display:flex;justify-content:space-between;align-items:end;gap:12px">
              <div><h2 id="intern-h">Verified Internships</h2><p class="muted">Curated roles with learning value and real mentorship.</p></div>

              <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
                <select id="filterTrack" class="input" aria-label="Filter by track"></select>
                <select id="filterLoc" class="input" aria-label="Filter by location"></select>
                <select id="filterType" class="input" aria-label="Filter by type"></select>
                <select id="filterPay" class="input" aria-label="Filter by pay"></select>
                <select id="sortBy" class="input" aria-label="Sort"></select>
              </div>
            </div>

            <div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px;gap:12px">
              <div style="display:flex;align-items:center;gap:8px">
                <span class="pill">View</span>
                <button class="btn" id="viewGrid" aria-pressed="true">üî≤ Grid</button>
                <button class="btn" id="viewList" aria-pressed="false">‚ò∞ List</button>
              </div>
              <div style="display:flex;gap:10px;align-items:center">
                <span id="resultInfo" class="muted">Loading‚Ä¶</span>
                <div style="display:flex;align-items:center;gap:8px">
                  <button class="btn" id="prevPage">‚óÄ Prev</button>
                  <span id="pageInfo" class="pill">Page 1</span>
                  <button class="btn" id="nextPage">Next ‚ñ∂</button>
                </div>
              </div>
            </div>

            <div id="internList" style="margin-top:12px;display:grid;gap:12px"></div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px">
              <div class="card"><strong>Compare (pick up to 3 saved)</strong><div id="compareWrap" style="margin-top:8px;display:grid;gap:8px"></div></div>
              <div class="card"><strong>Saved</strong><div id="savedWrap" style="margin-top:8px;display:grid;gap:8px"></div></div>
            </div>
          </section>

          <section id="portfolio" aria-labelledby="portfolio-h">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><h2 id="portfolio-h">Portfolio & Resume Builder</h2><p class="muted">Drag to reorder. Export JSON. Print r√©sum√© view.</p></div>
              <div style="display:flex;gap:8px">
                <button class="btn" id="addProject">‚ûï Add Project</button>
                <button class="btn" id="exportPortfolio">‚¨áÔ∏è Export</button>
                <button class="btn" id="printResume">üñ®Ô∏è Print</button>
                <button class="btn" id="clearPortfolio">üóëÔ∏è Clear</button>
              </div>
            </div>

            <div id="portfolioGrid" class="grid g-3" style="margin-top:12px"></div>

            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px">
              <div class="card"><strong>üéØ Badges earned</strong><div id="metricBadges" class="muted" style="margin-top:8px">0</div></div>
              <div class="card"><strong>‚≠ê Saved roles</strong><div id="metricSaved" class="muted" style="margin-top:8px">0</div></div>
              <div class="card"><strong>üì¶ Projects</strong><div id="metricProjects" class="muted" style="margin-top:8px">0</div></div>
            </div>
          </section>

          <footer>
            <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
              <div style="display:flex;align-items:center;gap:10px"><div class="sb-logo">üîó</div><strong>Linktern</strong></div>
              <div class="muted">¬© <span id="year"></span> Linktern ‚Äî Explore ‚Ä¢ Learn ‚Ä¢ Link</div>
              <div style="display:flex;gap:8px;align-items:center">
                <button class="pill" id="themeToggle">üåì Theme</button>
              </div>
            </div>
          </footer>
        </div>
      </main>
    </div>
  </div>

  <!-- Drawer -->
  <aside id="drawer" aria-hidden="true" aria-label="Internship details" style="position:fixed;right:0;top:0;height:100vh;width:min(560px,96%);transform:translateX(100%);transition:transform .28s var(--ease);z-index:220;padding:18px">
    <div class="card" style="height:100%;display:flex;flex-direction:column">
      <header style="display:flex;align-items:center;justify-content:space-between">
        <div>
          <strong id="drawerTitle">Role</strong>
          <div class="muted" id="drawerCompany" style="font-size:.95rem"></div>
        </div>
        <button class="btn" id="drawerClose" aria-label="Close drawer">‚úñ</button>
      </header>
      <div id="drawerBody" style="margin-top:12px;overflow:auto"></div>
    </div>
  </aside>

  <!-- Dialogs -->
  <dialog id="settingsModal" aria-label="Settings">
    <form method="dialog" style="padding:0;border-radius:12px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:14px;border-bottom:1px solid rgba(255,255,255,0.02)">
        <h2 style="margin:0">Settings</h2>
        <button class="btn">‚úñ</button>
      </div>
      <div style="padding:14px;display:grid;gap:10px;width:min(720px,92vw)">
        <div style="display:flex;gap:12px;align-items:center">
          <label style="min-width:100px"><strong>Accent</strong></label>
          <select id="accentPicker" class="input" style="max-width:260px;">
            <option value="mint">Mint</option><option value="blue">Blue</option><option value="violet">Violet</option><option value="rose">Rose</option><option value="amber">Amber</option>
          </select>
          <button class="btn" id="resetPrefs">Reset</button>
        </div>
        <div style="display:flex;gap:12px;align-items:center">
          <label style="min-width:100px"><strong>Density</strong></label>
          <select id="densityPicker" class="input" style="max-width:160px;">
            <option value="cozy">Cozy</option><option value="compact">Compact</option><option value="comfy">Comfy</option>
          </select>
          <label style="min-width:100px"><strong>Text</strong></label>
          <select id="fsPicker" class="input" style="max-width:120px;"><option value="0.92">Small</option><option value="1" selected>Normal</option><option value="1.1">Large</option></select>
        </div>
        <div style="margin-top:6px;color:var(--muted);font-size:.95rem">Keyboard: <kbd class="kbd">‚åò/Ctrl+K</kbd> opens command palette; <kbd class="kbd">/</kbd> focuses search; <kbd class="kbd">?</kbd> shows shortcuts.</div>
      </div>
    </form>
  </dialog>

  <dialog id="quizModal" aria-label="Career Quiz">
    <form method="dialog" style="padding:0;border-radius:12px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid rgba(255,255,255,0.02)">
        <h2 style="margin:0">Career Discovery Quiz</h2><button class="btn">‚úñ</button>
      </div>
      <div style="padding:14px">
        <div class="row cols-2">
          <div class="card">
            <h3>Questions</h3>
            <div id="quizForm" style="margin-top:10px"></div>
            <button class="btn cta" id="quizSubmit" style="margin-top:10px">See My Matches</button>
          </div>
          <div class="card">
            <h3>Your Match</h3>
            <p id="quizResult" class="muted" style="font-size:1rem">Answer questions to see a suggested track and internships.</p>
            <div id="quizBadges" style="margin-top:8px;display:grid;gap:8px"></div>
          </div>
        </div>
      </div>
    </form>
  </dialog>

  <dialog id="simModal" aria-label="Role Simulation">
    <form method="dialog" style="padding:0;border-radius:12px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid rgba(255,255,255,0.02)">
        <h2 style="margin:0">Try This Role</h2><button class="btn">‚úñ</button>
      </div>
      <div style="padding:14px">
        <div style="display:grid;gap:12px">
          <div class="card">
            <h3>Pick a Simulation</h3>
            <div class="tabs" id="simTabs" style="display:flex;gap:8px"></div>
            <div id="simContent" style="margin-top:12px"></div>
          </div>
          <div class="card">
            <h3>Submit & Feedback</h3>
            <textarea id="simAnswer" rows="6" class="input" placeholder="Write your approach‚Ä¶"></textarea>
            <div style="display:flex;gap:8px;margin-top:10px">
              <button class="btn cta" id="simSubmit">Submit</button>
              <button class="btn" id="simBadge">Claim Practice Badge</button>
            </div>
            <div id="simFeedback" class="muted" style="margin-top:8px"></div>
          </div>
        </div>
      </div>
    </form>
  </dialog>

  <dialog id="storyModal" aria-label="Success Stories">
    <form method="dialog" style="padding:0;border-radius:12px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid rgba(255,255,255,0.02)">
        <h2 style="margin:0">Success Stories</h2><button class="btn">‚úñ</button>
      </div>
      <div style="padding:14px">
        <div id="storyGrid" style="display:grid;gap:12px"></div>
      </div>
    </form>
  </dialog>

  <dialog id="circleModal" aria-label="Join Mentorship Circle">
    <form method="dialog" style="padding:0;border-radius:12px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid rgba(255,255,255,0.02)">
        <h2 style="margin:0">Join a Mentorship Circle</h2><button class="btn">‚úñ</button>
      </div>
      <div style="padding:14px">
        <div style="display:grid;gap:12px">
          <div class="card">
            <h3>Request Invite</h3>
            <div style="display:grid;gap:8px">
              <label><strong>Track</strong></label>
              <select id="circleTrack" class="input"></select>
              <label><strong>Your Name</strong></label>
              <input id="circleName" class="input" placeholder="e.g., Kartik" />
              <label><strong>Email</strong></label>
              <input id="circleMail" class="input" placeholder="you@example.com" />
              <button class="btn cta" id="circleJoin" style="margin-top:6px">Request Invite</button>
              <div id="circleMsg" class="muted" style="margin-top:8px"></div>
            </div>
          </div>
          <div class="card">
            <h3>What you get</h3>
            <ul style="margin-top:8px">
              <li>Small-group mentor time</li>
              <li>Peer accountability</li>
              <li>Priority for partner roles</li>
            </ul>
          </div>
        </div>
      </div>
    </form>
  </dialog>

  <dialog id="projectModal" aria-label="Add Project">
    <form method="dialog" style="padding:0;border-radius:12px;overflow:hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid rgba(255,255,255,0.02)">
        <h2 style="margin:0">Add Project</h2><button class="btn">‚úñ</button>
      </div>
      <div style="padding:14px">
        <div style="display:grid;gap:12px">
          <div class="card">
            <div style="display:grid;gap:8px">
              <label><strong>Title</strong></label><input id="prTitle" class="input" />
              <label><strong>Track</strong></label><select id="prTrack" class="input"></select>
              <label><strong>Summary</strong></label><textarea id="prSummary" rows="4" class="input"></textarea>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
                <div><label><strong>Skills (comma)</strong></label><input id="prSkills" class="input" placeholder="Python, Figma, SQL" /></div>
                <div><label><strong>Links (comma)</strong></label><input id="prLinks" class="input" placeholder="repo, demo" /></div>
              </div>
              <button class="btn cta" id="prSave" style="margin-top:8px">Save Project</button>
              <div id="prMsg" class="muted" style="margin-top:6px"></div>
            </div>
          </div>
        </div>
      </div>
    </form>
  </dialog>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>
  <button id="backTop" title="Back to top" style="position:fixed;right:18px;bottom:90px;z-index:300;padding:10px;border-radius:12px;background:linear-gradient(180deg,var(--glass),transparent);display:none">‚Üë Top</button>

  <script>
  /* ===================== DATA ===================== */
  const TRACKS = [
    {id:'data',name:'Data Science',color:'var(--accent-blue)',modules:['Intro to Python','EDA','SQL Basics','Modeling']},
    {id:'ux',name:'Product Design',color:'var(--accent-violet)',modules:['Design Thinking','Wireframing','Prototyping','User Research']},
    {id:'web',name:'Frontend',color:'var(--accent-mint)',modules:['HTML/CSS','JS Fundamentals','React','Performance']},
    {id:'pm',name:'Product Mgmt',color:'var(--accent-amber)',modules:['Roadmaps','Metrics','Stakeholders','Delivery']}
  ];

  const DISCOVER = [
    {title:'Role Quiz: Find Your Fit',cat:'all',icon:'üß≠',desc:'Answer quick questions and receive a starter plan.',action:()=>openModal('quizModal')},
    {title:'Data Analyst Simulation',cat:'tech',icon:'üìä',desc:'Inspect a small dataset and outline KPIs.'},
    {title:'Micro UX Challenge',cat:'design',icon:'üé®',desc:'Design a signup flow in 10 minutes.'}
  ];

  const MENTORS = [
    {name:'Aditya',title:'Data Analyst @ Gojek',track:'data'},
    {name:'Maya',title:'Product Designer @ Traveloka',track:'ux'},
    {name:'Rafi',title:'Frontend @ Tokopedia',track:'web'},
    {name:'Tara',title:'PM @ Stripe',track:'pm'}
  ];

  const INTERNSHIPS = [
    {id:1,company:'Gojek',role:'Data Analyst Intern',track:'data',loc:'Indonesia',added:'2025-09-14',pay:'Paid',type:'Summer',url:'#'},
    {id:2,company:'Shopee',role:'UX Design Intern',track:'ux',loc:'Singapore',added:'2025-09-01',pay:'Paid',type:'3‚Äì6 mo',url:'#'},
    {id:3,company:'Tokopedia',role:'Frontend Intern',track:'web',loc:'Indonesia',added:'2025-08-22',pay:'Paid',type:'6 mo',url:'#'},
    {id:4,company:'Stripe',role:'PM Intern',track:'pm',loc:'Remote',added:'2025-10-01',pay:'Paid',type:'3‚Äì6 mo',url:'#'}
  ];

  const STORIES = [
    {name:'Aila ‚Äî From projects to Data role',body:'Started with the quiz, finished Data track, shipped dashboards, and got a summer offer.'},
    {name:'Vyandra ‚Äî Designed a product and landed interviews',body:'Built portfolio projects and improved interview outcomes.'}
  ];

  const SIMS = [
    {id:'data',name:'Data Analyst',prompt:'Outline KPIs and a quick SQL/Pandas approach for user retention.'},
    {id:'ux',name:'Product Designer',prompt:'Sketch the primary task flow and metrics to measure success.'}
  ];

  /* ===================== STATE & HELPERS ===================== */
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  const defaults = {
    theme: localStorage.getItem('theme') || 'dark',
    accent: localStorage.getItem('accent') || 'mint',
    density: localStorage.getItem('density') || 'cozy',
    fs: parseFloat(localStorage.getItem('fs')||'1'),
    badges: new Set(JSON.parse(localStorage.getItem('badges')||'[]')),
    favs: new Set(JSON.parse(localStorage.getItem('favs')||'[]')),
    compare: new Set(JSON.parse(localStorage.getItem('compare')||'[]')),
    notes: JSON.parse(localStorage.getItem('notes')||'{}'),
    portfolio: JSON.parse(localStorage.getItem('portfolio')||'[]'),
    page: 1, perPage: 6, view: 'grid', selectedTrack: 'data', speed: 'standard'
  };
  const state = {...defaults};

  function save(){
    try{
      localStorage.setItem('theme', state.theme);
      localStorage.setItem('accent', state.accent);
      localStorage.setItem('density', state.density);
      localStorage.setItem('fs', state.fs);
      localStorage.setItem('badges', JSON.stringify([...state.badges]));
      localStorage.setItem('favs', JSON.stringify([...state.favs]));
      localStorage.setItem('compare', JSON.stringify([...state.compare]));
      localStorage.setItem('notes', JSON.stringify(state.notes));
      localStorage.setItem('portfolio', JSON.stringify(state.portfolio));
    }catch(e){ /* storage might be disabled */ }
  }

  function applyTheme(){ if(state.theme==='auto'){ document.documentElement.removeAttribute('data-theme'); } else document.documentElement.setAttribute('data-theme', state.theme); }
  function applyAccent(){
    const map = {mint:'var(--accent-mint)', blue:'var(--accent-blue)', violet:'var(--accent-violet)', rose:'var(--accent-rose)', amber:'var(--accent-amber)'};
    document.documentElement.style.setProperty('--accent', map[state.accent] || map.mint);
  }
  function applyDensity(){ const v = state.density; document.documentElement.style.setProperty('--gap', v==='compact'?'8px':v==='comfy'?'20px':'14px'); }
  function applyFS(){ document.documentElement.style.setProperty('--fs', state.fs); document.documentElement.style.fontSize = `calc(16px * var(--fs, 1))`; }

  const el = (t, a = {}, ...c) => {
    const e = Object.assign(document.createElement(t), a);
    for (const x of c) {
      if (typeof x === 'string') e.appendChild(document.createTextNode(x));
      else if (x) e.appendChild(x);
    }
    return e;
  };

  const openModal = (id, preset) => {
    const d = document.getElementById(id);
    if (!d) return;
    if (preset && id === 'simModal') selectSim(preset);
    if(typeof d.showModal === 'function') d.showModal();
    else d.style.display = 'block';
  };
  const closeModal = (id) => {
    const d = document.getElementById(id);
    if (!d) return;
    if(typeof d.close === 'function') d.close();
    else d.style.display = 'none';
  };
  const jump = id => document.getElementById(id)?.scrollIntoView({behavior:'smooth', block:'start'});

  const toastEl = $('#toast');
  let toastTimer = null;
  function toast(m, ms=1600){
    if(!toastEl) return;
    if(toastTimer) clearTimeout(toastTimer);
    toastEl.textContent = m;
    toastEl.classList.add('show');
    toastTimer = setTimeout(()=> toastEl.classList.remove('show'), ms);
  }

  const debounce = (fn,ms=200)=>{ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a),ms)}};
  const clamp = (v,a,b)=> Math.max(a, Math.min(b, v));

  /* CURSOR */
  (function cursorFactory(){
    const dot = $('#cursorDot'), ring = $('#cursorRing');
    if(!dot || !ring) return;
    let tx = innerWidth/2, ty = innerHeight/2, x = tx, y = ty, rx = tx, ry = ty;
    const lerp = (a,b,t)=> a + (b-a)*t;
    document.addEventListener('pointermove', (e)=>{ tx = e.clientX; ty = e.clientY; dot.style.opacity = 1; ring.style.opacity = 1; }, {passive:true});
    document.addEventListener('pointerdown', ()=> {
      dot.style.transform = `translate(${tx}px,${ty}px) scale(0.8)`; ring.style.transform = `translate(${tx}px,${ty}px) scale(0.9)`; setTimeout(()=>{ dot.style.transform = ''; ring.style.transform=''; },120);
    });
    function loop(){
      x = lerp(x, tx, 0.28);
      y = lerp(y, ty, 0.28);
      rx = lerp(rx, tx, 0.12);
      ry = lerp(ry, ty, 0.12);
      dot.style.left = x + 'px'; dot.style.top = y + 'px';
      ring.style.left = rx + 'px'; ring.style.top = ry + 'px';
      requestAnimationFrame(loop);
    }
    loop();
    // hover scale on actionable elements
    document.addEventListener('pointerover', (e)=> {
      const target = e.target.closest('button, a, .btn, .tab, .sb-btn, .magnet');
      if(target){ ring.style.transform = 'translate(-50%,-50%) scale(1.16)'; ring.style.borderColor = 'color-mix(in oklab, var(--accent) 80%, transparent)'; }
    });
    document.addEventListener('pointerout', (e)=> {
      const target = e.target.closest('button, a, .btn, .tab, .sb-btn, .magnet');
      if(target){ ring.style.transform = 'translate(-50%,-50%) scale(1)'; ring.style.borderColor = ''; }
    });
  })();

  /* REVEAL / PARALLAX */
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(ent=>{
      if(ent.isIntersecting){
        ent.target.classList.add('show');
        io.unobserve(ent.target);
      }
    });
  }, {threshold:0.12});
  function revealScan(){ $$('[data-parallax], .reveal').forEach(elm=> io.observe(elm)); }
  const parallaxEls = [...$$('[data-parallax]')];
  let ticking=false;
  function onScrollParallax(){
    if(ticking) return;
    ticking = true;
    requestAnimationFrame(()=> {
      parallaxEls.forEach(el=>{
        const f = parseFloat(el.dataset.parallax || 0.06);
        const rect = el.getBoundingClientRect();
        el.style.transform = `translateY(${Math.round(rect.top * f * -0.08)}px)`;
      });
      ticking=false;
    });
  }
  addEventListener('scroll', debounce(onScrollParallax, 8), {passive:true});

  /* SEARCH SUGGEST */
  function buildSuggestions(q){
    if(!q) return [];
    const src = [...INTERNSHIPS.map(i=> i.role + ' at ' + i.company), ...TRACKS.map(t=> t.name), ...DISCOVER.map(d=> d.title)];
    return src.filter(s=> s.toLowerCase().includes(q.toLowerCase())).slice(0,6);
  }

  /* RENDER HELPERS */
  function renderHeat(){
    const wrap = $('#heat'); if(!wrap) return; wrap.innerHTML=''; const days = 30; const done = state.badges.size;
    for(let i=0;i<days;i++){
      const s = document.createElement('div');
      s.style.width='10px'; s.style.height='10px'; s.style.borderRadius='4px';
      s.style.background = i < Math.min(days, done) ? 'linear-gradient(135deg,var(--accent),var(--accent-blue))' : 'rgba(255,255,255,0.03)';
      wrap.appendChild(s);
    }
  }

  function renderDiscover(filter='all'){
    const grid = $('#discoverGrid'); if(!grid) return; grid.innerHTML='';
    const items = DISCOVER.filter(x=> filter==='all' || x.cat===filter);
    const enriched = [...items, ...items.map(i=>({...i, title: i.title+' +' }))];
    enriched.forEach((item)=>{
      const card = el('article',{className:'card reveal magnet',tabIndex:0});
      card.innerHTML = `<div style="display:flex;align-items:center;justify-content:space-between"><h3 style="margin:0">${item.icon} ${item.title}</h3><span class="chip">${item.cat}</span></div><p class="muted" style="margin-top:8px">${item.desc}</p>`;
      const actions = el('div',{style:'margin-top:12px;display:flex;gap:8px;align-items:center'});
      const open = el('button',{className:'btn'}, 'Open');
      open.addEventListener('click', ()=> item.action ? item.action() : toast('Opening...'));
      actions.appendChild(open);
      card.appendChild(actions);
      grid.appendChild(card);
    });
    revealScan();
    bindMagnet();
  }

  function renderTrackTabs(){
    const tabs = $('#trackTabs'); if(!tabs) return; tabs.innerHTML='';
    TRACKS.forEach(t=>{
      const b = el('button',{className:'btn', onclick:()=>{ state.selectedTrack = t.id; save(); renderTrackTabs(); renderTrackContent(); updateRecommendations(); }}, t.name);
      if(t.id === state.selectedTrack) b.classList.add('cta');
      tabs.appendChild(b);
    });
  }
  function renderTrackContent(){
    const t = TRACKS.find(x=>x.id===state.selectedTrack);
    const box = $('#trackContent'); if(!box) return;
    box.innerHTML = `
      <div style="display:flex;gap:12px;align-items:center">
        <div style="width:10px;height:40px;background:linear-gradient(180deg,var(--accent),var(--accent-blue));border-radius:6px"></div>
        <div>
          <h4 style="margin:0">${t.name}</h4>
          <div class="muted" style="margin-top:6px">${t.modules.join(' ‚Ä¢ ')}</div>
        </div>
      </div>
      <div style="display:flex;gap:8px;margin-top:12px">
        <button class="btn" id="previewTrack">Preview</button>
        <button class="btn cta" id="startTrack">Start Track</button>
      </div>
    `;
    $('#previewTrack')?.addEventListener('click', ()=> toast('Previewing track...'));
    $('#startTrack')?.addEventListener('click', ()=>{ state.badges.add(`${t.id}-started`); save(); renderBadges(); updateRecommendations(); toast('Track started'); updateMetrics(); });
  }

  function renderBadges(){
    const wrap = $('#badges'); if(!wrap) return; wrap.innerHTML='';
    if(!state.badges.size){ wrap.appendChild(el('span',{className:'chip'},'No badges yet. Complete a module!')); return; }
    [...state.badges].forEach(b=>{
      const d = el('div', {className:'card'}, b);
      wrap.appendChild(d);
    });
  }

  function renderMentors(){
    const grid = $('#mentorGrid'); if(!grid) return; grid.innerHTML='';
    MENTORS.forEach(m=>{
      const card = el('article',{className:'card reveal magnet'});
      card.innerHTML = `<div style="display:flex;gap:12px;align-items:center">
        <div class="pill" style="min-width:44px;min-height:44px;display:grid;place-items:center;border-radius:10px;background:linear-gradient(180deg,var(--glass),transparent)">${m.name[0]}</div>
        <div><strong>${m.name}</strong><div class="muted">${m.title}</div></div>
        </div>
        <div style="margin-top:10px"><button class="btn">Request Intro</button></div>`;
      grid.appendChild(card);
    });
    revealScan();
    bindMagnet();
  }

  function updateFilters(){
    const sel = $('#filterTrack'); if(!sel) return; sel.innerHTML=''; sel.appendChild(el('option',{value:'all'}, 'All tracks'));
    TRACKS.forEach(t=> sel.appendChild(el('option',{value:t.id, selected:t.id===state.selectedTrack}, t.name)));
    const loc = $('#filterLoc'); if(loc) { loc.innerHTML=''; ['all','Remote','Indonesia','Singapore','India'].forEach(o=> loc.appendChild(el('option',{value:o}, o==='all'?'All locations':o))); }
    const type = $('#filterType'); if(type){ type.innerHTML=''; ['all','Summer','3‚Äì6 mo','6 mo'].forEach(o=> type.appendChild(el('option',{value:o}, o==='all'?'All types':o))); }
    const pay = $('#filterPay'); if(pay){ pay.innerHTML=''; ['all','Paid','Unpaid'].forEach(o=> pay.appendChild(el('option',{value:o}, o==='all'?'Any pay':o))); }
    const sort = $('#sortBy'); if(sort){ sort.innerHTML=''; [['recent','Most recent'],['company','Company'],['role','Role']].forEach(([v,label])=> sort.appendChild(el('option',{value:v}, label))); }
  }

  ;['filterTrack','filterLoc','filterType','filterPay','sortBy'].forEach(id=>{
    const elId = document.getElementById(id);
    if(elId) elId.addEventListener('change', ()=>{ state.page=1; renderInternships({}); });
  });

  $('#viewGrid')?.addEventListener('click', ()=>{ state.view='grid'; renderInternships({}); $('#viewGrid')?.setAttribute('aria-pressed','true'); $('#viewList')?.setAttribute('aria-pressed','false'); });
  $('#viewList')?.addEventListener('click', ()=>{ state.view='list'; renderInternships({}); $('#viewGrid')?.setAttribute('aria-pressed','false'); $('#viewList')?.setAttribute('aria-pressed','true'); });

  function paginate(arr){ const start=(state.page-1)*state.perPage; return arr.slice(start, start+state.perPage); }

  function highlight(txt,q){
    if(!q) return txt;
    const idx = txt.toLowerCase().indexOf(q.toLowerCase());
    if(idx<0) return txt;
    return txt.slice(0,idx) + `<mark>${txt.slice(idx,idx+q.length)}</mark>` + txt.slice(idx+q.length);
  }

  function renderInternships({q=''} = {}){
    const list = $('#internList'); if(!list) return; list.innerHTML='';
    const tval = $('#filterTrack')?.value || 'all', lval = $('#filterLoc')?.value || 'all', typeVal = $('#filterType')?.value || 'all', payVal = $('#filterPay')?.value || 'all', sort = $('#sortBy')?.value || 'recent';
    let items = INTERNSHIPS.filter(it=> (tval==='all'||it.track===tval) && (lval==='all'||it.loc===lval) && (typeVal==='all'||it.type===typeVal) && (payVal==='all'||it.pay===payVal) && (!q || (it.role+' '+it.company).toLowerCase().includes(q.toLowerCase())));
    const total = items.length;
    if(sort==='recent') items.sort((a,b)=> new Date(b.added)-new Date(a.added));
    if(sort==='company') items.sort((a,b)=> a.company.localeCompare(b.company));
    if(sort==='role') items.sort((a,b)=> a.role.localeCompare(b.role));
    const totalPages = Math.max(1, Math.ceil(items.length/state.perPage)); if(state.page>totalPages) state.page = totalPages;
    $('#pageInfo').textContent = `Page ${state.page} / ${totalPages}`; if($('#prevPage')) $('#prevPage').disabled = state.page===1; if($('#nextPage')) $('#nextPage').disabled = state.page===totalPages; $('#resultInfo').textContent = `${total} results`;
    const pageItems = paginate(items);
    for(const it of pageItems){
      const fav = state.favs.has(it.id); const cmp = state.compare.has(it.id);
      const wrap = el('div',{className:'intern-card reveal magnet'});
      const logo = el('div',{className:'intern-company'}, it.company[0]);
      const left = el('div',{style:'min-width:0'},
        el('div',{}, el('strong',{}, q ? highlight(it.role,q) : it.role)),
        el('div',{className:'intern-meta'}, `${TRACKS.find(t=>t.id===it.track)?.name||it.track} ‚Ä¢ ${it.loc} ‚Ä¢ ${it.type}`),
        el('div',{style:'margin-top:8px'}, el('textarea',{className:'input', rows:2, placeholder:'Notes (saved)', value: state.notes[it.id]||'', oninput:(e)=>{ state.notes[it.id]=e.target.value; save(); }}))
      );
      const actions = el('div',{style:'display:grid;gap:8px;justify-items:end;align-self:stretch'},
        el('div',{}, el('button',{className:'btn', onclick:()=>{ if(fav){ state.favs.delete(it.id); toast('Removed from saved'); } else { state.favs.add(it.id); toast('Saved'); } save(); renderInternships({q}); renderSaved(); updateMetrics(); }}, fav ? 'Saved' : 'Save')),
        el('div',{}, el('button',{className:'btn', onclick:()=>{ if(!cmp && state.compare.size>=3){ toast('Compare limit: 3'); return } if(cmp){ state.compare.delete(it.id); } else { state.compare.add(it.id); } save(); renderInternships({q}); renderCompare(); }}, cmp ? 'Remove' : 'Compare')),
        el('div',{}, el('button',{className:'btn', onclick:()=> openDrawer(it) }, 'Open'))
      );
      wrap.append(logo,left,actions);
      list.appendChild(wrap);
    }
    if(!items.length){ list.appendChild(el('p',{className:'muted'}, 'No results. Try another filter.')); }
    revealScan(); bindMagnet();
  }

  $('#prevPage')?.addEventListener('click', ()=>{ if(state.page>1){ state.page--; renderInternships({}); }});
  $('#nextPage')?.addEventListener('click', ()=>{ state.page++; renderInternships({}); });

  function renderSaved(){
    const wrap = $('#savedWrap'); if(!wrap) return; wrap.innerHTML=''; const saved = INTERNSHIPS.filter(i=> state.favs.has(i.id));
    if(!saved.length){ wrap.textContent = 'No saved roles yet.'; return; }
    saved.forEach(s=> wrap.appendChild(el('div',{className:'card reveal'}, el('strong',{}, s.role), el('div',{className:'muted'}, s.company))));
  }
  function renderCompare(){
    const wrap = $('#compareWrap'); if(!wrap) return; wrap.innerHTML=''; const items = INTERNSHIPS.filter(i=> state.compare.has(i.id));
    if(!items.length){ wrap.appendChild(el('p',{className:'muted'}, 'No items to compare.')); return; }
    items.forEach(it=> wrap.appendChild(el('div',{className:'card reveal'}, el('strong',{}, it.role), el('div',{className:'muted'}, it.company))));
  }

  /* DRAWER */
  function openDrawer(it){
    const d = $('#drawer'); if(!d) return;
    $('#drawerTitle').textContent = it.role;
    $('#drawerCompany').textContent = it.company;
    const b = $('#drawerBody'); b.innerHTML = '';
    b.appendChild(el('div',{className:'card'}, el('div',{className:'chip'}, it.company[0]), el('div',{}, el('strong',{}, it.company), el('div',{className:'muted'}, `${it.role} ‚Ä¢ ${it.loc} ‚Ä¢ ${it.type}`), el('p',{style:'margin-top:8px'}, 'Description: This role focuses on learning, mentorship and meaningful tasks.'))));
    d.style.transform = 'translateX(0)'; d.setAttribute('aria-hidden','false');
  }
  $('#drawerClose')?.addEventListener('click', ()=>{ $('#drawer').style.transform='translateX(100%)'; $('#drawer').setAttribute('aria-hidden','true'); });

  /* QUIZ / SIMS / STORIES */
  const QUIZ_QS = [
    {id:'q1',q:'Which activity sounds fun right now?',opts:[['data','Exploring patterns in a dataset'],['ux','Sketching an app flow'],['web','Coding a mini-site'],['pm','Scoping an MVP']]}
  ];
  function renderQuiz(){
    const form = $('#quizForm'); if(!form) return; form.innerHTML='';
    QUIZ_QS.forEach(({id,q,opts})=>{
      const field = el('div', {}, el('label',{}, q));
      const sel = el('select',{className:'input', id});
      sel.appendChild(el('option',{value:''}, 'Choose...'));
      opts.forEach(([v,label])=> sel.appendChild(el('option',{value:v}, label)));
      field.appendChild(sel);
      form.appendChild(field);
    });
  }
  $('#quizSubmit')?.addEventListener('click', ()=>{ const picks = {}; QUIZ_QS.forEach(({id})=>{ const v = document.getElementById(id).value; if(v) picks[v] = (picks[v]||0)+1; }); const picked = Object.keys(picks).sort((a,b)=> picks[b]-picks[a])[0] || state.selectedTrack; $('#quizResult').textContent = `Suggested track: ${TRACKS.find(t=>t.id===picked)?.name || picked}`; state.selectedTrack = picked; save(); renderTrackTabs(); renderTrackContent(); updateRecommendations(); toast('Matches updated'); $('#quizBadges').innerHTML = ''; renderBadges(); });

  function renderSimTabs(){ const wrap=$('#simTabs'); if(!wrap) return; wrap.innerHTML=''; SIMS.forEach(s=> wrap.appendChild(el('button',{className:'btn', onclick:()=>selectSim(s.id)}, s.name))); }
  function selectSim(id){ const s = SIMS.find(x=>x.id===id) || SIMS[0]; $$('#simTabs .btn').forEach(t=> t.classList.toggle('cta', t.textContent === s.name)); $('#simContent').innerHTML = `<div class="muted">${s.prompt}</div>`; }
  $('#simSubmit')?.addEventListener('click', ()=>{ const ans = $('#simAnswer')?.value?.trim(); if(!ans){ $('#simFeedback').textContent = 'Write your approach first.'; return; } $('#simFeedback').textContent = 'Submitted ‚Äî mentor review will follow.'; toast('Simulation submitted'); });

  $('#simBadge')?.addEventListener('click', ()=>{ state.badges.add(`${state.selectedTrack}-practice`); save(); renderBadges(); toast('Practice badge added'); updateMetrics(); });

  function renderStories(){ const grid = $('#storyGrid'); if(!grid) return; grid.innerHTML=''; STORIES.forEach(s=> grid.appendChild(el('article',{className:'card reveal'}, el('h3',{}, s.name), el('p',{className:'muted'}, s.body)))); revealScan(); }

  /* PORTFOLIO */
  function renderPortfolio(){ const grid = $('#portfolioGrid'); if(!grid) return; grid.innerHTML=''; if(!state.portfolio.length){ grid.appendChild(el('p',{className:'muted'}, 'No projects added yet.')); return; }
    state.portfolio.forEach((p, idx)=>{
      const card = el('div',{className:'card reveal', draggable:true});
      card.appendChild(el('strong',{}, p.title));
      card.appendChild(el('div',{className:'muted'}, p.track));
      card.appendChild(el('p',{}, p.summary));
      card.addEventListener('dragstart', e=> e.dataTransfer.setData('text/plain', idx));
      card.addEventListener('dragover', e=> e.preventDefault());
      card.addEventListener('drop', e=>{
        e.preventDefault();
        const from = parseInt(e.dataTransfer.getData('text/plain'),10); const to = idx;
        const item = state.portfolio.splice(from,1)[0]; state.portfolio.splice(to,0,item); save(); renderPortfolio(); updateMetrics();
      });
      grid.appendChild(card);
    });
    revealScan();
  }
  $('#addProject')?.addEventListener('click', ()=>{ fillTrackSelects(); openModal('projectModal'); });
  $('#prSave')?.addEventListener('click', ()=>{ const title = $('#prTitle')?.value.trim(); const summary = $('#prSummary')?.value.trim(); const track = $('#prTrack')?.value; if(!title || !summary){ $('#prMsg').textContent = 'Add title and summary'; return; } state.portfolio.push({title,summary,track}); save(); renderPortfolio(); updateMetrics(); $('#prMsg').textContent='Saved'; setTimeout(()=> closeModal('projectModal'), 700); });

  $('#exportPortfolio')?.addEventListener('click', ()=>{ try{ const data = new Blob([JSON.stringify(state.portfolio,null,2)],{type:'application/json'}); const url = URL.createObjectURL(data); const a = document.createElement('a'); a.href=url; a.download='portfolio.json'; a.click(); URL.revokeObjectURL(url); toast('Export ready'); }catch(e){ toast('Export failed'); } });
  $('#clearPortfolio')?.addEventListener('click', ()=>{ if(confirm('Clear all projects?')){ state.portfolio = []; save(); renderPortfolio(); updateMetrics(); }});
  $('#printResume')?.addEventListener('click', ()=>{ window.print(); toast('Opening print dialog‚Ä¶'); });

  /* COMMAND PALETTE & SHORTCUTS */
  const commands = [
    {k:'quiz',label:'Open Quiz',action:()=>{ renderQuiz(); openModal('quizModal'); }},
    {k:'stories',label:'Open Stories',action:()=>{ renderStories(); openModal('storyModal'); }},
    {k:'sim',label:'Open Sim',action:()=>{ renderSimTabs(); selectSim('data'); openModal('simModal'); }}
  ];
  function openPalette(){
    const overlay = document.createElement('div'); overlay.style.cssText = 'position:fixed;inset:0;z-index:800;display:grid;place-items:center;background:rgba(0,0,0,.36)';
    const box = document.createElement('div'); box.style.cssText='width:min(720px,92%);background:var(--surface);padding:14px;border-radius:12px;box-shadow:var(--card-shadow)';
    const input = el('input',{className:'input', placeholder:'Type a command or search‚Ä¶', style:'width:100%;'});
    box.appendChild(input);
    const list = el('div',{style:'margin-top:10px;display:grid;gap:8px;max-height:260px;overflow:auto'});
    commands.forEach(c=> list.appendChild(el('button',{className:'btn', onclick:()=>{ c.action(); document.body.removeChild(overlay); }}, c.label)));
    box.appendChild(list); overlay.appendChild(box);
    overlay.addEventListener('click', (e)=>{ if(e.target===overlay) document.body.removeChild(overlay); });
    document.body.appendChild(overlay); input.focus();
  }
  $('#openPalette')?.addEventListener('click', openPalette);

  /* search suggest UI */
  const suggestBox = $('#searchSuggest');
  $('#search')?.addEventListener('input', debounce((e)=>{
    const q = e.target.value.trim();
    if(!suggestBox) return;
    const data = buildSuggestions(q);
    suggestBox.innerHTML = '';
    if(!data.length){ suggestBox.style.display='none'; return; }
    data.forEach(s=>{
      const b = el('button',{className:'btn', style:'display:block; width:100%; textAlign:left'}, s);
      b.addEventListener('click', ()=>{ $('#search').value = s; suggestBox.style.display='none'; renderInternships({q:s}); jump('internships'); });
      suggestBox.appendChild(b);
    });
    suggestBox.style.display='block';
  },120));
  addEventListener('click', (e)=>{ if(!e.target.closest('#search')) suggestBox && (suggestBox.style.display='none'); });

  /* MICRO FX: magnet */
  function bindMagnet(){
    const els = [...$$('.magnet')];
    els.forEach(el=>{
      el.onmousemove = (e)=>{ const r = el.getBoundingClientRect(); const x = ((e.clientX-r.left)/r.width - .5) * 8; const y = ((e.clientY-r.top)/r.height - .5) * 8; el.style.transform = `translate3d(${x}px,${y}px,0) scale(1.01)`; };
      el.onmouseleave = ()=>{ el.style.transform = 'translate3d(0,0,0)'; };
    });
  }

  /* METRICS */
  function animateCounter(el, to, dur=800){
    if(!el) return;
    const from = parseInt(el.textContent.replace(/,/g,'')) || 0; const start = performance.now();
    const step = (t)=>{ const p = Math.min(1,(t-start)/dur); const val = Math.round(from + (to-from) * (1- Math.pow(1-p,3))); el.textContent = val.toLocaleString(); if(p<1) requestAnimationFrame(step); };
    requestAnimationFrame(step);
  }
  function updateMetrics(){
    const badges = state.badges.size, saved = state.favs.size, projects = state.portfolio.length;
    animateCounter($('#metricBadges'), badges, 600);
    animateCounter($('#metricSaved'), saved, 600);
    animateCounter($('#metricProjects'), projects, 600);
  }

  /* RECOMMENDATIONS */
  function updateRecommendations(){
    const reco = $('#recoList'); if(!reco) return; reco.innerHTML='';
    const focus = state.selectedTrack; const done = [...state.badges].filter(b=>b.startsWith(focus)).length; const extra = Math.min(2, Math.floor(done/2));
    const relevant = INTERNSHIPS.filter(i=>i.track===focus).slice(0,3+extra);
    relevant.forEach(it=>{
      const card = el('div',{className:'card magnet'}, el('div',{className:'chip'}, it.company[0]), el('div',{}, el('strong',{}, it.role), el('div',{className:'muted'}, it.company)));
      reco.appendChild(card);
    });
    $('#aiStatus').textContent = state.badges.size ? `Ready ‚Äî ${state.badges.size} modules done` : 'Waiting for your quiz‚Ä¶';
  }

  /* CIRCLE FORM */
  $('#joinCircle')?.addEventListener('click', ()=>{ fillTrackSelects(); openModal('circleModal'); });
  $('#circleJoin')?.addEventListener('click', ()=>{ const name = $('#circleName')?.value.trim(), mail = $('#circleMail')?.value.trim(); if(!name || !mail){ $('#circleMsg').textContent = 'Please add name & email'; return; } $('#circleMsg').textContent = 'Request sent ‚Äî we will email invite soon'; toast('Requested invite'); setTimeout(()=> closeModal('circleModal'), 900); });

  /* BACK TO TOP */
  $('#backTop')?.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));
  addEventListener('scroll', debounce(()=>{
    const bt = $('#backTop'); if(bt) bt.style.display = window.scrollY > 400 ? 'block' : 'none';
  }, 100), {passive:true});

  /* UTIL */
  function fillTrackSelects(){
    ['filterTrack','circleTrack','prTrack'].forEach(id=>{
      const sel = document.getElementById(id); if(!sel) return; sel.innerHTML=''; TRACKS.forEach(t=> sel.appendChild(el('option',{value:t.id}, t.name)));
    });
  }

  /* INIT */
  function init(){
    applyTheme(); applyAccent(); applyDensity(); applyFS();
    document.getElementById('year').textContent = new Date().getFullYear();

    renderHeat(); renderDiscover('all'); renderMentors(); renderTrackTabs(); renderTrackContent(); renderBadges(); updateFilters(); renderInternships({}); renderSaved(); renderCompare(); renderPortfolio(); updateRecommendations(); updateMetrics(); renderStories();
    $('#startQuiz')?.addEventListener('click', ()=>{ renderQuiz(); openModal('quizModal'); });
    $('#openStories')?.addEventListener('click', ()=>{ renderStories(); openModal('storyModal'); });
    $('#openSim')?.addEventListener('click', ()=>{ renderSimTabs(); selectSim('data'); openModal('simModal'); });
    $('#kbdHint')?.addEventListener('click', openPalette);

    $('#openSettings')?.addEventListener('click', ()=> openModal('settingsModal'));
    $('#themeToggle')?.addEventListener('click', ()=>{ state.theme = state.theme==='light'?'dark':state.theme==='dark'?'auto':'light'; save(); applyTheme(); toast('Theme: '+state.theme); });
    $('#accentPicker')?.addEventListener('change', e=>{ state.accent = e.target.value; save(); applyAccent(); toast('Accent: '+state.accent); });
    $('#densityPicker')?.addEventListener('change', e=>{ state.density = e.target.value; save(); applyDensity(); toast('Density: '+state.density); });
    $('#fsPicker')?.addEventListener('change', e=>{ state.fs = parseFloat(e.target.value); save(); applyFS(); toast('Text size changed'); });
    $('#resetPrefs')?.addEventListener('click', ()=>{ localStorage.clear(); Object.assign(state, defaults); save(); applyAccent(); applyDensity(); applyFS(); renderBadges(); renderPortfolio(); updateMetrics(); toast('Preferences reset'); });

    $('#searchBtn')?.addEventListener('click', ()=>{ const q = ($('#search')?.value || '').trim(); if(!q){ toast('Type something to search'); return; } renderInternships({q}); jump('internships'); });
    $('#searchInline')?.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); const q = e.target.value.trim(); renderInternships({q}); jump('internships'); }});
    $('#searchBtnInline')?.addEventListener('click', ()=>{ const q = $('#searchInline')?.value.trim(); renderInternships({q}); jump('internships'); });

    addEventListener('keydown', (e)=> {
      if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='k'){ e.preventDefault(); openPalette(); }
      if(e.key==='/' && (document.activeElement.tagName.toLowerCase()!=='input')){ e.preventDefault(); $('#search')?.focus(); }
      if(e.key==='?' ){ openPalette(); }
    });

    revealScan();
    requestAnimationFrame(onScrollParallax);
    animateCounter($('#statCountries'), 50, 900);
    animateCounter($('#statLearners'), 3000, 1100);
  }
  init();

  window._linktern = {state, save, renderInternships, renderPortfolio};
  </script>
</body>
</html>
